/**
 * Author and copyright: Stefan Haack (https://shaack.com)
 * Repository: https://github.com/shaack/bootstrap-input-spinner
 * License: MIT, see file 'LICENSE'
 */
!function(t){"use strict";var n=!1,e=t.fn.val;function a(t,e){t.addEventListener("mousedown",function(t){t.preventDefault(),e(t)}),t.addEventListener("touchstart",function(t){t.cancelable&&t.preventDefault(),e(t)}),t.addEventListener("keydown",function(t){32!==t.keyCode&&13!==t.keyCode||n||(n=!0,e(t))})}t.fn.val=function(n){if(arguments.length>=1&&this[0]&&this[0]["bootstrap-input-spinner"]&&this[0].setValue){var a=this[0];setTimeout(function(){a.setValue(n),t(a).change()})}return e.apply(this,arguments)},t.fn.InputSpinner=t.fn.inputSpinner=function(e){var o={decrementButton:"<strong>-</strong>",incrementButton:"<strong>+</strong>",groupClass:"",inputClass:"",buttonsClass:"btn-outline-secondary",buttonsWidth:"2.5rem",textAlign:"center",autoDelay:500,autoInterval:100,boostThreshold:10,boostMultiplier:"auto",locale:null,disabledInput:!1,loopable:!1};for(var r in e)o[r]=e[r];var i='<div class="input-group '+o.groupClass+'"><div class="input-group-prepend"><button style="min-width: '+o.buttonsWidth+'" class="btn btn-decrement '+o.buttonsClass+'" type="button">'+o.decrementButton+'</button></div><input type="text" inputmode="numeric" style="text-align: '+o.textAlign+'" class="form-control '+o.inputClass+'"'+(o.disabledInput?" disabled":"")+'/><div class="input-group-append"><button style="min-width: '+o.buttonsWidth+'" class="btn btn-increment '+o.buttonsClass+'" type="button">'+o.incrementButton+"</button></div></div>",u=o.locale||navigator.language||"en-US";return this.each(function(){var e=t(this);e[0]["bootstrap-input-spinner"]=!0,e.hide();var r=null,p=null,s="auto"===o.boostMultiplier,l=s?1:o.boostMultiplier,d=t(i),c=d.find(".btn-decrement"),f=d.find(".btn-increment"),v=d.find("input"),m=null,b=null,g=null,h=null,y=null,I=null,x=null;W();var C,E,w=parseFloat(e[0].value),N=0,M=e.attr("data-prefix")||"",F=e.attr("data-suffix")||"";if(M){var T=t('<span class="input-group-text">'+M+"</span>");d.find(".input-group-prepend").append(T)}if(F){var k=t('<span class="input-group-text">'+F+"</span>");d.find(".input-group-append").prepend(k)}function D(t,n){var a=!1;return void 0===n&&(n=!0),isNaN(t)||""===t?(e[0].value="",n&&(v[0].value=""),a=NaN!=w,w=NaN):(t=parseFloat(t),t=Math.min(Math.max(t,m),b),t=Math.round(t*Math.pow(10,y))/Math.pow(10,y),e[0].value=t,n&&(v[0].value=x.format(t)),a=w!=t,w=t),a}function L(t,n,e){n&&setTimeout(function(){var a;"function"==typeof CustomEvent?a=new CustomEvent(n,{bubbles:!0,detail:{step:e}}):(a=document.createEvent("Event")).initEvent(n,!0,!0,{step:e}),t[0].dispatchEvent(a)})}function B(t){(o.disabledInput||!v[0].disabled&&!v[0].readOnly)&&(S(t),V(),r=setTimeout(function(){p=setInterval(function(){N>o.boostThreshold?s?(S(t*parseInt(l,10)),l<1e8&&(l*=1.1),h&&(l=Math.min(h,l))):S(t*l):S(t),N++},o.autoInterval)},o.autoDelay))}function S(t){isNaN(w)&&(w=0);var n=w+t;if(o.loopable){var a=parseInt(e.prop("max")),r=parseInt(e.prop("min"));t>0&&n>a?n=n-a+r-1:t<0&&n<r&&(n=n-r+a+1)}D(n)&&(L(e,"input",t),L(e,"change",t))}function V(){N=0,l=l=s?1:o.boostMultiplier,clearTimeout(r),clearTimeout(p)}function W(){v.prop("required",e.prop("required")),v.prop("placeholder",e.prop("placeholder"));var n=o.disabledInput||e.prop("disabled"),a=e.prop("readonly");v.prop("disabled",n),v.prop("readonly",a);var r=!o.disabledInput&&n||a,i=!o.loopable&&parseInt(e.val()||v.val())==parseInt(e.attr("max")),p=!o.loopable&&parseInt(e.val()||v.val())==parseInt(e.attr("min"));f.prop("disabled",r||i),c.prop("disabled",r||p),(r||i||p)&&V();var s=e.prop("class"),l="";/form-control-sm/g.test(s)?l="input-group-sm":/form-control-lg/g.test(s)&&(l="input-group-lg");var C=s.replace(/form-control(-(sm|lg))?/g,"");d.prop("class","input-group "+l+" "+o.groupClass),v.prop("class","form-control "+C+" "+o.inputClass),t.each(e.data(),function(t,n){v.attr(`data-${t}`,n)}),m=parseFloat(e.prop("min"))||0,b=isNaN(e.prop("max"))||""===e.prop("max")?1/0:parseFloat(e.prop("max")),g=parseFloat(e.prop("step"))||1,h=parseInt(e.attr("data-step-max"))||0;var E=parseInt(e.attr("data-decimals"))||0,w=!("false"===e.attr("data-digit-grouping"));y===E&&I===w||(y=E,I=w,x=new Intl.NumberFormat(u,{minimumFractionDigits:y,maximumFractionDigits:y,useGrouping:I}))}e[0].setValue=function(t){D(t)},new MutationObserver(function(){D(w,!0),W()}).observe(e[0],{attributes:!0}),e.after(d),D(w),v.on("paste input change focusout",function(t){var n,a,o,r,i=v[0].value,p="focusout"===t.type;n=i,a=new Intl.NumberFormat(u),o=a.format(1111).replace(/1/g,""),r=a.format(1.1).replace(/1/g,""),D(i=parseFloat(n.replace(new RegExp("\\"+o,"g"),"").replace(new RegExp("\\"+r),".")),p),L(e,t.type)}),e.on("change",function(){W()}),a(c[0],function(){B(-g)}),a(f[0],function(){B(g)}),C=document.body,E=function(){V()},C.addEventListener("mouseup",function(t){E(t)}),C.addEventListener("touchend",function(t){E(t)}),C.addEventListener("keyup",function(t){32!==t.keyCode&&13!==t.keyCode||(n=!1,E(t))})}),this}}(jQuery);